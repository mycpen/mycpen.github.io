<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="content-language" content="zh-cn"><meta name="keywords" content="Mycpen,Blog,学习分享,博客,笔记,开发,编程"><meta name="apple-mobile-web-app-title" content="Mycpen"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><meta name="msvalidate.01" content="2D08C94FAECAF1E9FBF3F79657F2906F"><meta name="google-site-verification" content="5jJNeWCOgSzXuAeGzPNgbyKyTkZhoGh47zpVZciGkrU"><title>01_转载-图床搭建 Backblaze B2 + Cloudflare CDN | Mycpen</title><meta name="description" content="文章转载"><meta property="og:type" content="article"><meta property="og:title" content="01_转载-图床搭建 Backblaze B2 + Cloudflare CDN"><meta property="og:url" content="https://blog1.cpen.top/posts/16589f92.html"><meta property="og:site_name" content="Mycpen"><meta property="og:description" content="文章转载"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234175.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234730.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234897.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234770.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234174.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234496.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234558.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234323.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234511.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234756.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262252472.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262253539.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262253084.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262254668.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262255445.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262256761.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262257026.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262258762.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262258597.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262259760.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262259217.png"><meta property="og:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262300765.png"><meta property="article:published_time" content="2022-12-03T04:00:00.000Z"><meta property="article:modified_time" content="2023-06-16T05:00:00.000Z"><meta property="article:author" content="Mycpen"><meta property="article:tag" content="转载"><meta property="article:tag" content="图床"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234175.png"><link rel="canonical" href="https://blog1.cpen.top/posts/16589f92.html"><link rel="alternate" href="true" title="Mycpen" type="application/atom+xml"><link rel="icon" href="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/img/favicon.png" type="image/x-icon"><link rel="stylesheet" href="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/css/style.css"><link href="//cdn.cbd.int/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet"><link rel="apple-touch-icon" href="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/img/avatar.jpg" media="defer" onload='this.media="all"'><link rel="bookmark" href="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/img/avatar.jpg" media="defer" onload='this.media="all"'><link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/img/avatar.jpg" media="defer" onload='this.media="all"'></head><body class="main-center theme-purple" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="/" target="_self"><img class="img-circle img-rotate" src="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/img/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Mycpen</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">记录学习历程与受益知识</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> China</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/"><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-resources"><a href="/resources/"><i class="icon icon-star-fill"></i> <span class="menu-title">资源</span></a></li><li class="menu-item menu-item-links"><a href="/links/"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/mycpen" rel="external nofollow noreferrer" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="mailto:mycpen@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email" data-toggle="tooltip" data-placement="top"><i class="icon icon-email"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title"><i style="color:#9400d3" class="icon icon-stackexchange"></i>公告</h3><div class="widget-body"><div id="board"><div class="content"><p>博客迁移至 <a href="https://blog.cpen.top/" rel="external nofollow noreferrer" target="_self" style="color:#5ca1ff">https://blog.cpen.top/</a></p></div></div></div></div><div class="widget"><h3 class="widget-title"><i style="color:#9400d3" class="icon icon-tags"></i>标签云</h3><div class="widget-body tagcloud"><a href="/tags/Django/" style="font-size:16.33px;color:#fff">Django</a> <a href="/tags/MTV/" style="font-size:14.11px;color:#fff">MTV</a> <a href="/tags/URL/" style="font-size:14.11px;color:#fff">URL</a> <a href="/tags/HTTP/" style="font-size:14.11px;color:#fff">HTTP</a> <a href="/tags/%E7%8A%B6%E6%80%81%E7%A0%81/" style="font-size:13px;color:#fff">状态码</a> <a href="/tags/GET/" style="font-size:13px;color:#fff">GET</a> <a href="/tags/POST/" style="font-size:13px;color:#fff">POST</a> <a href="/tags/MVC/" style="font-size:13px;color:#fff">MVC</a> <a href="/tags/Error/" style="font-size:15.22px;color:#fff">Error</a> <a href="/tags/Nginx/" style="font-size:16.33px;color:#fff">Nginx</a> <a href="/tags/Troubleshooting/" style="font-size:15.22px;color:#fff">Troubleshooting</a> <a href="/tags/Git/" style="font-size:16.33px;color:#fff">Git</a> <a href="/tags/Hexo/" style="font-size:21.89px;color:#fff">Hexo</a> <a href="/tags/Pure/" style="font-size:13px;color:#fff">Pure</a> <a href="/tags/Twikoo/" style="font-size:14.11px;color:#fff">Twikoo</a> <a href="/tags/PJAX/" style="font-size:13px;color:#fff">PJAX</a> <a href="/tags/Element/" style="font-size:13px;color:#fff">Element</a> <a href="/tags/%E6%8F%92%E4%BB%B6/" style="font-size:13px;color:#fff">插件</a> <a href="/tags/%E5%AD%97%E4%BD%93/" style="font-size:13px;color:#fff">字体</a> <a href="/tags/Replit/" style="font-size:14.11px;color:#fff">Replit</a> <a href="/tags/GitHub/" style="font-size:18.56px;color:#fff">GitHub</a> <a href="/tags/NPM/" style="font-size:13px;color:#fff">NPM</a> <a href="/tags/Java/" style="font-size:15.22px;color:#fff">Java</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px;color:#fff">编码</a> <a href="/tags/%E8%BF%90%E7%AE%97%E7%AC%A6/" style="font-size:13px;color:#fff">运算符</a> <a href="/tags/%E8%BF%9B%E5%88%B6/" style="font-size:13px;color:#fff">进制</a> <a href="/tags/Other/" style="font-size:19.67px;color:#fff">Other</a> <a href="/tags/Supervisor/" style="font-size:13px;color:#fff">Supervisor</a> <a href="/tags/AList/" style="font-size:13px;color:#fff">AList</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size:13px;color:#fff">工具</a> <a href="/tags/Python/" style="font-size:20.78px;color:#fff">Python</a> <a href="/tags/FTP/" style="font-size:14.11px;color:#fff">FTP</a> <a href="/tags/Open/" style="font-size:13px;color:#fff">Open</a> <a href="/tags/TinyPNG/" style="font-size:13px;color:#fff">TinyPNG</a> <a href="/tags/SSH/" style="font-size:16.33px;color:#fff">SSH</a> <a href="/tags/Linux/" style="font-size:23px;color:#fff">Linux</a> <a href="/tags/Crontab/" style="font-size:13px;color:#fff">Crontab</a> <a href="/tags/Vim/" style="font-size:13px;color:#fff">Vim</a> <a href="/tags/Shell/" style="font-size:19.67px;color:#fff">Shell</a> <a href="/tags/%E7%94%A8%E6%88%B7%E4%B8%8E%E7%BB%84/" style="font-size:14.11px;color:#fff">用户与组</a> <a href="/tags/%E6%9D%83%E9%99%90/" style="font-size:15.22px;color:#fff">权限</a> <a href="/tags/Ansible/" style="font-size:14.11px;color:#fff">Ansible</a> <a href="/tags/DNS/" style="font-size:13px;color:#fff">DNS</a> <a href="/tags/NFS/" style="font-size:13px;color:#fff">NFS</a> <a href="/tags/Awk/" style="font-size:14.11px;color:#fff">Awk</a> <a href="/tags/Sed/" style="font-size:14.11px;color:#fff">Sed</a> <a href="/tags/PHP/" style="font-size:13px;color:#fff">PHP</a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13px;color:#fff">脚本</a> <a href="/tags/%E7%8E%AF%E5%A2%83/" style="font-size:13px;color:#fff">环境</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size:14.11px;color:#fff">数据类型</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13px;color:#fff">算法</a> <a href="/tags/%E6%A8%A1%E5%9D%97/" style="font-size:14.11px;color:#fff">模块</a> <a href="/tags/Mail/" style="font-size:13px;color:#fff">Mail</a> <a href="/tags/Psutil/" style="font-size:13px;color:#fff">Psutil</a> <a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size:13px;color:#fff">函数</a> <a href="/tags/OOP/" style="font-size:13px;color:#fff">OOP</a> <a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size:13px;color:#fff">内存管理</a> <a href="/tags/%E8%BD%AC%E8%BD%BD/" style="font-size:17.44px;color:#fff">转载</a> <a href="/tags/%E5%9B%BE%E5%BA%8A/" style="font-size:13px;color:#fff">图床</a> <a href="/tags/%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/" style="font-size:13px;color:#fff">上下文管理器</a> <a href="/tags/Memos/" style="font-size:13px;color:#fff">Memos</a> <a href="/tags/%E5%AD%A6%E4%B9%A0/" style="font-size:15.22px;color:#fff">学习</a> <a href="/tags/%E4%B9%A0%E6%83%AF/" style="font-size:14.11px;color:#fff">习惯</a></div></div><script>for(var everytag=document.getElementsByClassName("widget-body tagcloud")[0].children,i=everytag.length-1;i>=0;i--){var r=Math.floor(180*Math.random()),g=Math.floor(180*Math.random()),b=Math.floor(180*Math.random());everytag[i].style.background="rgb("+r+","+g+","+b+")"}</script><div class="widget"><h3 class="widget-title"><i style="color:#9400d3" class="icon icon-folder-open"></i>分类</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Error/">Error</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">30</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a><span class="category-list-count">6</span></li></ul></div></div><div class="widget"><h3 class="widget-title"><i style="color:#9400d3" class="icon icon-archives-fill"></i>归档</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/">2023</a><span class="archive-list-count">13</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">65</span></li></ul></div></div><div class="widget"><h3 class="widget-title"><i style="color:#9400d3" class="icon icon-shu-fill"></i>最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Hexo/">Hexo</a></p><p class="item-title"><a href="/posts/db7b8b04.html" class="title">13_Hexo-操作记录</a></p><p class="item-date"><time datetime="2023-06-01T04:00:00.000Z" itemprop="datePublished">2023-06-01</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Hexo/">Hexo</a></p><p class="item-title"><a href="/posts/8d01af11.html" class="title">12_Hexo-GitHub Actions 发布博客静态资源至 NPM</a></p><p class="item-date"><time datetime="2023-05-05T04:00:00.000Z" itemprop="datePublished">2023-05-05</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a></p><p class="item-title"><a href="/posts/85a8374a.html" class="title">06_转载-自我提升的8个好习惯</a></p><p class="item-date"><time datetime="2023-05-04T04:00:00.000Z" itemprop="datePublished">2023-05-04</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a></p><p class="item-title"><a href="/posts/285c50ae.html" class="title">05_转载-延寿指南-反向面试-文档写作规范</a></p><p class="item-date"><time datetime="2023-05-03T04:00:00.000Z" itemprop="datePublished">2023-05-03</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a></p><p class="item-title"><a href="/posts/beb8baf2.html" class="title">04_转载-提问的智慧</a></p><p class="item-date"><time datetime="2023-05-02T04:00:00.000Z" itemprop="datePublished">2023-05-02</time></p></div></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E9%93%BE%E6%8E%A5"><span class="toc-number">1.</span> <span class="toc-text">相关链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E8%BD%BD%E6%96%87%E7%AB%A0"><span class="toc-number">2.</span> <span class="toc-text">转载文章</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E7%AB%A01%EF%BC%9ABackblaze-B2-Cloudflare-CDN"><span class="toc-number">3.</span> <span class="toc-text">文章1：Backblaze B2 + Cloudflare CDN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E5%9B%BE%E5%BA%8A%E6%95%99%E7%A8%8B%E5%BC%80%E5%A7%8B"><span class="toc-number">3.1.</span> <span class="toc-text">搭建自定义域名图床教程开始</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E7%AB%A02%EF%BC%9ABackblaze-B2-Cloudflare-CDN-PicGo"><span class="toc-number">4.</span> <span class="toc-text">文章2：Backblaze B2 + Cloudflare CDN + PicGo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">4.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">前置条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Backblaze-OSS%E9%83%A8%E5%88%86"><span class="toc-number">4.3.</span> <span class="toc-text">Backblaze OSS部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cloudflare%E9%83%A8%E5%88%86"><span class="toc-number">4.4.</span> <span class="toc-text">Cloudflare部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E9%85%8DPicGo%E6%9B%B4%E5%A5%BD%E7%9A%84%E8%BF%9B%E8%A1%8C%E5%9B%BE%E5%BA%8A%E9%A3%9F%E7%94%A8"><span class="toc-number">4.5.</span> <span class="toc-text">搭配PicGo更好的进行图床食用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">4.6.</span> <span class="toc-text">注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E7%AB%A03%EF%BC%9ABackblaze-B2-Cloudflare"><span class="toc-number">5.</span> <span class="toc-text">文章3：Backblaze B2 + Cloudflare</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A6%81%E6%B1%82"><span class="toc-number">5.1.</span> <span class="toc-text">要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E6%A1%B6"><span class="toc-number">5.2.</span> <span class="toc-text">创建存储桶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AECloudflare"><span class="toc-number">5.3.</span> <span class="toc-text">配置Cloudflare</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.4.</span> <span class="toc-text">参考</span></a></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-转载/01_转载-图床搭建-BackblazeB2-CloudflareCDN" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">01_转载-图床搭建 Backblaze B2 + Cloudflare CDN</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar"></i> <a href="/posts/16589f92.html" class="article-date">发布于 <time datetime="2022-12-03T04:00:00.000Z" itemprop="datePublished">2022-12-03</time></a></span><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/posts/16589f92.html" class="article-date">更新于 <time datetime="2023-06-16T05:00:00.000Z" itemprop="dateUpdated">2023-06-16</time></a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/%E8%BD%AC%E8%BD%BD/">转载</a></span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/%E5%9B%BE%E5%BA%8A/" rel="tag">图床</a>, <a class="article-tag-link-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">转载</a></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/posts/16589f92.html#comments" class="article-comment-link">评论</a></span> <span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 5.7k(字)</span> <span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 20(分)</span></div></div><div class="article-toc-notice" style="background-color:#d7bde2;border:1px solid #d7bde2;border-radius:10px;padding:5px"><b>注</b>：点击此处或下方 <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span style="color:#c71585">[&nbsp;</span><span style="color:#c71585">文章目录</span><i style="color:red" class="text-collapsed icon icon-anchor"></i><i class="text-in icon icon-close"></i> <span style="color:#c71585">]</span></a> 以展开或折叠目录</div><br><div class="article-entry marked-body" itemprop="articleBody"><h2 id="相关链接">相关链接<a class="header-anchor" href="#相关链接"></a></h2><ol><li class="lvl-3"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blazeb2.js.org/">BlazeB2 - 基于 BackBlazeB2 和 Cloudflare 的图床工具（未使用）</a></li></ol><h2 id="转载文章">转载文章<a class="header-anchor" href="#转载文章"></a></h2><ol><li class="lvl-3"><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.coca.cc/mf/37.html">Backblaze B2 + Cloudflare CDN可自定义域名的10G高速免费外链图床</a></p></li><li class="lvl-3"><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.winer.website/archives/use_blackblaze_b2_and_cloudflare_cdn_to_bulid_a_free_oss.html">使用Backblaze B2 + Cloudflare CDN + PicGo实现可自定义域名的10G免费图床解决方案</a></p></li><li class="lvl-3"><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.bloade.com/2022/06/20/%E4%BD%BF%E7%94%A8backblaze-b2%E5%92%8Ccloudflare%E4%BD%9C%E4%B8%BA%E5%85%8D%E8%B4%B9%E5%9B%BE%E5%BA%8A/">使用Backblaze B2和Cloudflare作为免费图床</a></p></li></ol><p>感谢 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://recreyed.tk/">ReCreyed</a> 的分享。以下内容全文摘自上面 3 篇文章</p><h2 id="文章1：Backblaze-B2-Cloudflare-CDN">文章1：Backblaze B2 + Cloudflare CDN<a class="header-anchor" href="#文章1：Backblaze-B2-Cloudflare-CDN"></a></h2><p>本博客其他文章使用的都是github图床，无意中发现了B2+CF+ShareX的自建图床方案，而且还可以自定义域名，所以就有了这篇文章，本文所有图片全部来自这种方法的图床。</p><p>图床指的就是储存图片的服务器，网站管理员为了方便维护和管理，会将图片存放在专门的服务器集群里，通常还会在外层套层 CDN 做分发。市面上的公开图床很多，例如 imgur、<a target="_blank" rel="noopener external nofollow noreferrer" href="http://sm.ms">sm.ms</a>、imgbox 等等，这些图床都开放了 API 方便开发者调用。不过由于运营成本问题，也有不少图床相继倒闭或者转入收费。</p><p>怎么自建图床？如果是有VPS主机服务器，安装个Chevereto 开源图床网站程序即可。但这是VPS单纯用来做图床给博客外链图片用，有点浪费且不易长久。图片存储最好是放在大公司的云服务平台上， Backblaze B2 是一个云存储解决方案，类似于Amazon AWS S3, 但是价格稍微便宜一些. Backblaze的云存储每个注册用户拥有10G免费空间以及每天1G的下载流量，上传流量不限。超过免费额度后的价格以及与其他几家主流商家的对比见下图。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234175.png" alt=""></p><p>在backblaze存储1T的内容也仅需$5/月，不过流量费还是比较贵的 ，上传流量不限。 由于 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cloudflare.com/bandwidth-alliance/">Bandwidth Alliance(带宽联盟)</a>，Backblaze 到 Cloudflare 之间的出口是完全免费的， 所以Backblaze B2可以配合cloudflare CDN来使用达到无限免费下载流量。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234730.png" alt=""></p><p>Backblaze宣布与Cloudflare合作，免除掉Backblaze到Cloudflare的流量费用。</p><p>因此我们得到如下网盘/图床产品：</p><ul class="lvl-0"><li class="lvl-2"><p>10G存储空间免费， 全球最可靠的云存储服务</p></li><li class="lvl-2"><p>上行免费</p></li><li class="lvl-2"><p>下行免费</p></li><li class="lvl-2"><p>可自定义域名</p></li><li class="lvl-2"><p>全球最强CDN加速</p></li></ul><h3 id="搭建自定义域名图床教程开始">搭建自定义域名图床教程开始<a class="header-anchor" href="#搭建自定义域名图床教程开始"></a></h3><p>首先，你需要有一个域名，选择一个子域名作为图床的域名。 关于图床的二级域名命名，一般有以下几种：</p><ul class="lvl-0"><li class="lvl-2"><p>img</p></li><li class="lvl-2"><p>images</p></li><li class="lvl-2"><p>assets</p></li><li class="lvl-2"><p>static （不仅存放图片，还有存放 css、js）</p></li></ul><p>然后，创建 Backblaze B2 Bucket(存储桶) 。</p><p>在<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.backblaze.com/">Backblaze’s B2 storage</a> 注册一个账号，注册好了后，在后台面板选择 “Buckets”（存储桶），然后点击 “Create a Bucket”，创建一个存储桶。选Public，以便所有人可访问。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234897.png" alt=""></p><p>然后，回到 “Buckets(存储桶)” , 在你刚刚创建的存储桶上，点击 “Upload/Download(上传/下载)”. 上传一个临时的测试文件到存储桶中，然后在你刚上传的文件处，点击 “i(information，信息)”. 这是为了获取下一步需要的信息，你的存储桶处于哪台服务器上.</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234770.png" alt=""></p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234174.png" alt=""></p><p>在上面的截图中，可以看到，我的文件是放在 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://f000.backblazeb2.com/">https://f000.backblazeb2.com/</a> – 记住这个域名<br>最后，获取到地址之后就登录cloudflare，给你的域名添加一个子域名，并新增一条cname记录，指向文件地址中的域名，<a target="_blank" rel="noopener external nofollow noreferrer" href="http://xn--img-uc0ep96boud.coca.xn--cccnamef000-b48rf915dg7a.backblazeb2.com">例如将img.coca.cc通过cname到f000.backblazeb2.com</a>，效果便是<a target="_blank" rel="noopener external nofollow noreferrer" href="https://img.coca.cc/file/imgsgj/img.jpg">https://img.coca.cc/file/imgsgj/img.jpg</a> 指向 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://f001.backblazeb2.com/file/imgsgj/img.jpg">https://f001.backblazeb2.com/file/imgsgj/img.jpg</a></p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234496.png" alt=""></p><p>根据上面截图中的记录, 我使用这个子域名 img.coca.cc作为图床的域名, 并且指向 <a target="_blank" rel="noopener external nofollow noreferrer" href="http://f000.backblazeb2.com">f000.backblazeb2.com</a>. 确保 Cloudflare 橙色保护盾是开启的状态, 这代表请求是通过了 Cloudflare 的 CDN 代理层. Cloudflare 默认的 TTL 将被设置为 auto(自动).</p><p>虽然启用了CloudFlare CDN，但发现缓存永远不能命中（MISS），我们需要对添加一个缓存指令（默认是不缓存），打开存储桶设置，桶信息设置为{“cache-control”:“max-age=43200”}，其中43200单位为秒(s)，意思就是说43200秒内CF不会去从源站重新获取资源。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234558.png" alt=""></p><p>Cloudfalre的ssl设置需要使用full，因为backblaze仅提供https访问地址。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234323.png" alt=""></p><p>当然你如果觉得文件链接不好看太长了，你也可以使用cloudflare自带的页面规则301 ，缩短链接地址，比如通过 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://img.coca.cc/img.jpg">https://img.coca.cc/img.jpg</a> 直接访问 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://f001.backblazeb2.com/file/imgsgj/img.jpg">https://f001.backblazeb2.com/file/imgsgj/img.jpg</a> 。<br>例:<br>匹配规则 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://img.coca.cc/">https://img.coca.cc/</a>*<br>重定向网址到 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://f001.backblazeb2.com/file/imgsgj/$1">https://f001.backblazeb2.com/file/imgsgj/$1</a></p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234511.png" alt=""></p><p>加一条页面缓存规则</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262234756.png" alt=""></p><p>最后，请注意：Backblaze B2 流出到 Cloudflare 的流量是免费的，也就是说就算 CF 回源 B2 也没有 $0.01/GB 的流出流量费，相当于免费无限流量。不过这并不能阻止坏蛋直接用 B2 的域名（而不是套了 CF 的域名）刷流量。</p><p>最后修改：2021 年 03 月 01 日</p><h2 id="文章2：Backblaze-B2-Cloudflare-CDN-PicGo">文章2：Backblaze B2 + Cloudflare CDN + PicGo<a class="header-anchor" href="#文章2：Backblaze-B2-Cloudflare-CDN-PicGo"></a></h2><h3 id="前言">前言<a class="header-anchor" href="#前言"></a></h3><p>近期，由于服务器需要扩展功能，以及阿里云推送日志时有所不便决定重新购买服务器并部署相关网站和服务。决定趁此机会对图片存储进行规范，由于网站未备案，国内的阿里云OSS+阿里云CDN、又拍云、七牛云等厂家提供的服务无法享受，只能将目光转向国外。</p><p>原本使用Github+JSDelivr是一个很好的免费图床解决方案，且网上教程也很多，但2020年8月9日JSDelivr发布的新使用政策中第四条引起讨论</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">4. Prohibited Use</span><br><span class="line"></span><br><span class="line">The following behavior is prohibited:</span><br><span class="line"></span><br><span class="line"> 1. Hosting or accessing content that:</span><br><span class="line">     - contains malware or harmful code in any form,</span><br><span class="line">     - violates proprietary rights of others,</span><br><span class="line">     - is sexually explicit,</span><br><span class="line">     - is potentially illegal in the EU or the USA.</span><br><span class="line"></span><br><span class="line"> 2. Abusing the service and its resources, or using jsDelivr as a general-purpose</span><br><span class="line">    file or media hosting service. This includes, for example:</span><br><span class="line">     - running an image hosting website and using jsDelivr as a storage for all</span><br><span class="line">       uploaded images,</span><br><span class="line">     - hosting videos, file backups, or other files in large quantities.</span><br><span class="line"></span><br><span class="line">    We recognize that there are legitimate projects that consist of a large number</span><br><span class="line">    of files, and these are not considered abuse. For example: icons packs, apps,</span><br><span class="line">    or games with a large number of assets.Copy</span><br></pre></td></tr></table></figure><p><code>running an image hosting website and using jsDelivr as a storage for all uploaded images</code>这句话有所歧义，因为无法判断个人博客和文章上传的图片数量和访问量是否会被判定为图片存储站，导致封禁或删除数据，只能寻求其余解决方案。</p><p>此时发现<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cloudflare.com/zh-cn/bandwidth-alliance/">Cloudflare Bandwidth Alliance宽带联盟宽带联盟</a>中包含Backblaze，Backblaze到Cloudflare的所有出口流量完全免费。再加上Backblaze对个人用户提供10G的免费存储额度，每天1G的下载量与无限上传量。我们可以同时使用两者达到10G免费额度与不限量上传下载。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262252472.png" alt=""></p><p>在超过免费存储额度之后，相比其他几家国外主流OSS服务提供商，Backblaze的价格也较为低廉，唯一的缺点是目前只支持信用卡支付。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262253539.png" alt=""></p><h3 id="前置条件">前置条件<a class="header-anchor" href="#前置条件"></a></h3><ol><li class="lvl-3"><p>一个域名~ 最好是一级域名，即xxx.xxx这种类型的。搜索任意域名供应商即可购买，比较推荐NameSlio，支持支付宝付款，免费的Whois隐私保护，同时价格便宜。<code>.com</code>域名每年仅需要9.95美金，如果不是很在乎可以买其他后缀只买首年，2美金一年。免费域名也有一些可以申请，比较出名的就是freenom的域名了，不过听说今年Cloudflare的免费服务不再支持免费域名，所以只能自己试试是否能够成功。</p></li></ol><h3 id="Backblaze-OSS部分">Backblaze OSS部分<a class="header-anchor" href="#Backblaze-OSS部分"></a></h3><ol><li class="lvl-3"><p>从<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.backblaze.com/b2/cloud-storage.html">此处</a>进入，创建Backblaze账号并完善相关信息，直接从首页进入可能没有Sing Up选项</p></li><li class="lvl-3"><p>从<a target="_blank" rel="noopener external nofollow noreferrer" href="https://secure.backblaze.com/b2_buckets.htm">此处</a>进入控制台，创建Buckets存储桶存储桶</p></li><li class="lvl-3"><p>给存储桶起一个名字方便识别且不易被猜测即可，无需在意生成的图片链接长短，后续可以进行重定向方便识别且不易被猜测即可，无需在意生成的图片链接长短，后续可以进行301重定向，并将<code>Files in Bucket are</code>修改为<code>Public</code><br><strong>注意：给存储桶起名时尽量起不易被别人猜测的名字，可在其中增加部分随机字符，如<code>c42rx71-example-winer-website</code>，因为在存储桶的模式为Public时，别人只需知道你的OSS服务提供商+存储桶名称+其中一个文件名，即可拼凑出文件真实链接，从而绕过CDN刷空你的免费流量，如果有绑定支付方式还会扣费。</strong></p></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262253084.png" alt=""></p><ol><li class="lvl-3"><p>点击<code>Upload/Download</code>上传一张图片或临时文件，用于后续获取存储桶所在的服务器地址</p></li><li class="lvl-3"><p>从左侧菜单栏的<code>Browse Files</code>进入刚刚的存储桶并找到上传的文件，点击查看详细信息，记住<code>Friendly URL</code>行的链接内容</p></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262254668.png" alt=""></p><ol start="3"><li class="lvl-3"><p>从<code>Friendly URL</code>的链接可以看到我们的存储桶位于<code>https://f002.backblazeb2.com/</code>，而<code>/file/example-winer-website</code>则是存放文件目录的相对路径，记住这两个值后登陆Cloudflare进行设置。</p></li></ol><h3 id="Cloudflare部分">Cloudflare部分<a class="header-anchor" href="#Cloudflare部分"></a></h3><ol><li class="lvl-3"><p>打开<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cloudflare.com/zh-cn/">Cloudflare官网</a>并进行注册</p></li><li class="lvl-3"><p>根据提示前往域名注册商修改DNS解析服务器到Cloudflare提供给你的服务器地址不同用户地址不同不同用户地址不同，个人使用选择免费计划即可</p></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262255445.png" alt=""></p><ol start="3"><li class="lvl-3"><p>添加一条CNAME记录到你刚刚得到的存储桶服务器，二级域名可以根据喜好选择，但一般使用这几种</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">oss</span><br><span class="line">img</span><br><span class="line">images</span><br><span class="line">assets</span><br><span class="line">static(不仅存放图片，还存放网站加载时的css、js文件)</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262256761.png" alt=""></p><ol><li class="lvl-3"><p>此时等待DNS解析完成后我们就完成了通过Cloudflare访问Backblaze的设置，可以使用浏览器的开发者工具，访问二级域名下对应网址来查看是否命中CDN缓存。<code>cf-cache-status</code>行HIT代表命中缓存，MISS代表没有命中CDN缓存，回源到Backblaze，此时会消耗下载流量。</p></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262257026.png" alt=""></p><ol start="2"><li class="lvl-3"><p>为了避免无法命中缓存或回源次数过多导致加载速度低下，我们需要回到Backblaze进行桶信息设置，添加<code>&#123;&quot;cache-control&quot;:&quot;max-age=86400&quot;&#125;</code>，意味86400秒内Cloudflare不再返回源站重新获取信息。<br><strong>注意，回源时为CDN节点回源站重新拉去数据，然后再传递给用户，并不是将源站地址直接转给用户，所以无需担心回源过多导致的免费流量配额消耗完毕。max-age可以不用太长，太长的话若源文件发生更改，且站点没有主动推送到CDN节点时会导致用户不能及时得到最新版本。（书写本文时发现BackBlaze也存在免费请求次数显示，B类C类请求每天各2500次，暂时未确定Cloudflare访问是否计算请求次数，故也不建议太短）</strong></p></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262258762.png" alt=""></p><ol><li class="lvl-3"><p>可选可选<strong>不建议使用的重定向方式不建议使用的重定向方式</strong>通过cloudflare自带的页面规则301，对于文件连接进行重定向缩短链接地址。按照下图选项根据喜好进行创建即可，*用于匹配所有的图片路径及名称，<code>$1</code>代表使用星号部分的内容对网址进行补全。<br><strong>注意：</strong></p></li></ol><p><strong>1.匹配URL时，地址中的<code>/img</code>是必须的否则被转发过的URL会再次匹配到转发规则，造成重定向次数过多或其他位置错误，但是<code>/img</code>可以替换为任意不为<code>/file/example-winer-website(你的存储桶名)</code>的字符串</strong><br><strong>2.经过测试后发现，使用该方式进行的重定向在开发者工具Network页面可以抓取到重定向后的链接直接新标签打开图片也可以获取直接新标签打开图片也可以获取，从而得到你的存储桶名称以及真是文件名，配合服务器提供商即可拼凑真实地址进行恶意刷流量攻击。故建议使用第8步的第二种创建方式。</strong></p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262258597.png" alt=""></p><ol><li class="lvl-3"><p>可选可选在查找资料时，见到有些地方建议在进行URL重定向后增加一条页面缓存规则来防止缓存失效。按照下图进行配置即可。但是在我进行测试时发现不增加这条内容，也可以命中Cloudflare的CDN缓存，故暂时未添加。也可以在此处增加安全级别选项，并设置为<code>本质上为关</code>，来保证主站被攻击在CDN环节增加验证时，写在本地的Markdown文档能够正常加载图片。<br>猜测存在此步骤的可能原因是将缓存级别设置<code>无查询字符串</code>时仅在图片后不跟随参数时使用缓存的内容，部分OSS供应商提供追加参数对图片进行处理（如压缩、剪裁、缩放）后发送的功能，若主站缓存级别设置为标准，此处修改部分内容设置后就可以使用那些功能。但Backblaze的免费服务并不包含这些，所以暂时用不到。若以后发现在问题或真正的原因会进行补充说明。</p></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262259760.png" alt=""></p><p>8.可选可选<strong>建议使用的重定向方式建议使用的重定向方式</strong>由于不使用链接重定向和使用页面规则重定向均会暴露桶名称，我们选择通过重写的方式进行解决。这种方式可以在链接不变的情况下改写其中的内容。这次我们使用规则中的转换规则进行页面重写。匹配主机名用于确定请求来源需要进行重写，且再次匹配完整URI确认不包含已经重写过的链接，避免出现反复重写的错误。重写路径的concat含义为将两字符串拼接，在请求的文件路径前添加存储桶路径，而主机名example.winer.website在使用concat函数时无需书写，会自动添加为传入请求的主机名。（如一定要在concat函数内添加主机名，请不要带<code>http://</code>或<code>https://</code>开头，而是在前面添加<code>/</code>进行替代，例如<code>concat(&quot;/example.winer.website/file/example-winer-website&quot;, http.request.uri.path)</code>）<br>注：如果页面规则剩余不足或不想使用本方法，也可以<a target="_blank" rel="noopener external nofollow noreferrer" href="https://help.backblaze.com/hc/en-us/articles/360010017893-How-to-allow-Cloudflare-to-fetch-content-from-a-Backblaze-B2-private-bucket">参考本文</a>创建私有存储桶并使用Cloudflare Workers来进行访问。鉴于Workers访问方法已存在很久，且有众多其他博主教程，不再进行书写。但Workers同样有免费限额，请注意。</p><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262259217.png" alt=""></p><h3 id="搭配PicGo更好的进行图床食用">搭配PicGo更好的进行图床食用<a class="header-anchor" href="#搭配PicGo更好的进行图床食用"></a></h3><p>首先恭喜你，至此你已经完成了图床基本搭建工作！下面是拓展部分</p><ol><li class="lvl-3"><p>图床搭建完毕后，若不进行其他操作，每次上传图片都需要打开Backblaze的网站并在完成身份验证后进入桶设置页面进行上传，即不便捷也不友好。因此介绍一款跨平台且同时支持命令行与可视化界面的图片上传工具——PicGo<br>主要功能即为上传图片到你指定的位置，并获取图片链接，搭配typora编辑器可以直接在粘贴图片时就自动上传并将链接写入Markdown文档，避免图片在其它网站或放在本地后移动文档导致的图片丢失。</p></li><li class="lvl-3"><p>进入<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Molunerfinn/PicGo">项目主页</a>，下载并安装PicGo</p></li><li class="lvl-3"><p>选择插件设置，搜索<code>s3</code>或进入<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wayjam/picgo-plugin-s3">插件项目主页</a>下载并安装该插件</p></li><li class="lvl-3"><p>安装完毕后左侧的图床设置会多出“Amazon S3”，对于所有与S3 API兼容的云存储均可使用</p></li><li class="lvl-3"><p>打开的<a target="_blank" rel="noopener external nofollow noreferrer" href="https://secure.backblaze.com/app_keys.htm">Backblaze官网的AppKeys设置页面</a>，添加一个新的Key建议不要使用建议不要使用MasterApplicationKey，按照如下格式设置并申请Key<br><strong>注意：Key的最长有效时间为1000天，即86400000秒，过期后请重新申请</strong></p></li></ol><p><img src="https://cdn.iocdn.cc/npm/mycpen-image-bed@0.0.0-2022/image/202212262300765.png" alt=""></p><ol><li class="lvl-3"><p>记录得到的<code>Key ID、applicationKey、桶名称、桶的Endpoint地址</code>分别填写到对应位置。同时将301跳转或页面重写的网址填写到自定义域名。其余设置无需变更。保存后即可上传图片，也可以修改文件的命名方式或通过修改配置文件进行设置，详见<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wayjam/picgo-plugin-s3/blob/main/README.md">此页面</a>。</p></li></ol><h3 id="注意事项">注意事项<a class="header-anchor" href="#注意事项"></a></h3><p>到此为止所有工作都已完成，但是有一点需要注意：</p><ol><li class="lvl-3"><p>通过这种方式上传文件，文件路径中如果包含空格，在Backblaze存储时会将空格换为加号，所以路径中包含空格的文件PicGo上传后生成的链接并不正确。</p></li><li class="lvl-3"><p>通过此方法搭建的图床或书写的教程，切记不要泄露存储桶名称，避免刷流量，且建议给所有上传文件的命名规则添加哈希值，使其不可猜测，避免存储桶名称暴露时获取其他文件。</p></li></ol><p><strong>同时本文内建立的存储桶并未使用，教程书写完毕后立刻删除，并创建了及其难以猜测的存储桶名称更改了相关地址，无需尝试使用文中或图中的信息进行访问测试。</strong></p><p>最后修改：2022 年 08 月 28 日 10 : 37 AM</p><p>评论区</p><p><strong>刚下飞机的道士</strong> May 24th, 2022 at 11:48 am</p><p>感谢大佬文章，现在cloudflare提供了transform rules，可以不用worker进行路径重写了。</p><p><strong>sakuya</strong> April 9th, 2022 at 02:44 pm</p><p>友情提示：<br>第8步的concat&quot;/example.winer.website/file/example−winer−website&quot;,http.requrst.uri.paht)，似乎多了个括号，以及request、path写错了</p><p><strong><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.winer.website/">winer</a></strong> August 28th, 2022 at 10:36 am</p><p><strong><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.winer.website/archives/use_blackblaze_b2_and_cloudflare_cdn_to_bulid_a_free_oss.html#comment-10">@sakuya</a></strong></p><p>谢谢提醒，括号多的那个其实是因为外面有个中文的括号，只看有代码标记的里面就行<br>不过request和path确实是打错了hhhhh图片里还没错，这就改掉</p><h2 id="文章3：Backblaze-B2-Cloudflare">文章3：Backblaze B2 + Cloudflare<a class="header-anchor" href="#文章3：Backblaze-B2-Cloudflare"></a></h2><p>B2是Backblaze提供的一个OSS存储服务，有着10G的免费容量以及每天1G的免费流量。而且他还是Cloudflare带宽联盟的成员，通过Cloudflare传输Backblaze中的内容是完全免费的。即使在超出免费额度的情况下，$0.005 GB/Mo的的容量和$0.01 GB/Mo的流量价格比起其他存储服务的价格也十分便宜。</p><p>有许多其他文章也介绍了如何使用B2和CF作为免费图床，但现在CF有了新的转换规则功能，和其他文章使用的Worker和页面规则比起来，转换规则提供了更多的免费条目，也更易于使用。</p><p>当然用来作为网盘也可以，不过10G就不太够用了。</p><h3 id="要求">要求<a class="header-anchor" href="#要求"></a></h3><p>首先需要注册Backblaze B2和Cloudflare的账号，其次需要一个域名，现在Cloudflare就提供域名购买，也可以从namesilo或者其他地方购买后给Cloudflare解析。Backblaze注册之后需要进行邮箱验证，不然无法创建公开存储桶。</p><h3 id="创建存储桶">创建存储桶<a class="header-anchor" href="#创建存储桶"></a></h3><p>进入Backblaze的用户管理界面，选择B2云存储下面的桶选项，然后点击创建存储桶，创建时需要输入桶的名称，这个名称会包含在URL中，所以不能与其他人的桶活着自己的其他桶有同样的名字。创建时需要选中公众选项，将其设置为公开的，其他选项不需要修改。</p><p>在创建完成后可以在里面上传一张图片，点击上传后的图片，其中友好URL就是要使用的地址，接下来记录下友好URL的主机名，例如<code>f00x.backblaze2.com</code>。</p><p>刚创建的存储桶默认不会被Cloudflare缓存，而是每次都要回源，对于图床来说，缓存下来才更方便。点击桶选项，回到刚才创建存储桶的地方，可以看到已经创建好的存储桶，点击桶设定，将桶信息修改为<code>&#123;&quot;cache-control&quot;:&quot;max-age=43200&quot;&#125;</code>，其中<code>max-age=</code>后面的数字为Cloudflare的缓存时长，单位为秒。</p><h3 id="配置Cloudflare">配置Cloudflare<a class="header-anchor" href="#配置Cloudflare"></a></h3><p>在Cloudflare中为图床要使用的子域名创建一个CNAME记录，<a target="_blank" rel="noopener external nofollow noreferrer" href="http://xn--f00x-494f1jq3rrmbn6ibbz97pr8ij4jlsc52yhw1drh7d.bckblze2.com">将其指向刚才记录下的主机名f00x.bckblze2.com</a>，由于要使用Cloudflare的CDN进行缓存，所以要将代理状态设置为已代理。</p><p>在创建CNAME记录之后，将友好URL的主机名换成刚创建的域名就可以访问文件了。如果测试时Cloudflare提示错误522，这是因为Backblaze只允许使用Https访问，需要在Cloudflare的SSL/TLS中改成完全（严格）。此外，如果是Cloudflare的Pro付费用户的话，还需要关闭自动签名交换(SXG)，他在速度-优化选项中。</p><p>直接使用CNAME域名修改URL的话的话会暴露存储桶的名称，也显得URL十分啰嗦，这时候就需要使用Cloudflare的转换规则来将URL缩短。</p><p>选择规则-转换规则，然后点击创建转换规则-重写URL创建一个重写URL的规则，首先为规则取一个名字。如果使用单独的子域名作为专用的图床域名的话，可以直接在字段中选择主机名，在运算符中选择等于，然后在值当中输入子域名。</p><p>如果图床并不是使用专门的子域名，需要点击编写表达式，并参照<a target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.cloudflare.com/ruleset-engine/rules-language">Cloudflare文档</a>来编写如何匹配图床的URL地址。</p><p>匹配表达式配置完成后，在下面的重写-路径中选择重写到，在选项中选择Dynamic，如果只想在URL中删去<code>/file/存储桶</code>名称的话，在后面填写<code>concat(&quot;/file/存储桶名称&quot;, http.request.uri.path)</code>，如果有其他要求，也可以参照上面的Cloudflare文档来修改。设置完成后点击部署即可启用该规则。现在输入<code>https://img.example.com/桶中的文件路径</code>或是自定义的地址即可加载存储桶中的图片。</p><p>以下是用这种方式上传的图片，另外如果有人认得作者是谁可以在评论里回复一下。</p><p>图片略…</p><h3 id="参考">参考<a class="header-anchor" href="#参考"></a></h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.backblaze.com/blog/free-image-hosting-with-cloudflare-transform-rules-and-backblaze-b2/">Free Image Hosting With Cloudflare Transform Rules and Backblaze B2</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.coca.cc/mf/37.html">Backblaze B2 + Cloudflare CDN可自定义域名的10G高速免费外链图床</a></p><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://233.al/archives/b2-cf.html">Backblaze+CloudFlare实现0成本简单图床</a></p></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-license"><strong>文章作者：</strong> <a href="https://blog1.cpen.top" style="color:#e541e5">Mycpen</a></li><li class="post-copyright-link hidden-xs"><strong>文章链接：</strong> <a href="https://blog1.cpen.top/posts/16589f92.html" title="01_转载-图床搭建 Backblaze B2 + Cloudflare CDN" target="_blank" rel="external" style="color:#e541e5">https://blog1.cpen.top/posts/16589f92.html</a></li><li class="post-copyright-license"><strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="external" style="color:#e541e5">CC BY-NC-SA 4.0</a> 许可协议，转载请注明来自 <a href="https://blog1.cpen.top" style="color:#e541e5">Mycpen</a></li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="/" target="_blank" class="img-burn thumb-sm visible-lg"><img src="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/img/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="/" target="_blank"><span class="text-dark">Mycpen</span><small class="ml-1x">记录学习历程与受益知识</small></a></h3><div>Mycpen</div></div></figure></div></div></div></article><section id="comments"></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/posts/b7f58a40.html" title="06_Other-Windows 图片批量压缩工具 ultra-tinypng"><i class="icon icon-angle-left" aria-hidden="true"></i> <span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/posts/3ffec809.html" title="05_Other-使用 Python open 函数批量替换文件内容"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span style="color:#c71585">[&nbsp;</span><span style="color:#c71585">文章目录</span><i style="color:red" class="text-collapsed icon icon-anchor"></i><i class="text-in icon icon-close"></i> <span style="color:#c71585">]</span></a></li></ul><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq"></div></div></div></nav></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/mycpen" rel="external nofollow noreferrer" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="mailto:mycpen@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email" data-toggle="tooltip" data-placement="top"><i class="icon icon-email"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright"><b>&copy; &nbsp;2025 Mycpen</b><br><i class="icon icon-hezuo">&nbsp;&nbsp;</i><b>Powered by&nbsp;</b><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io/">Hexo</a>&nbsp;&nbsp;<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/cofess/hexo-theme-pure">Pure</a><div class="publishby" style="font-family:Courier"><i class="icon icon-clock"></i><span id="sitetime" style="font-family:Courier"></span></div><div class="publishby"><a href="https://beian.miit.gov.cn" target="_blank">苏ICP备2020069048号-1</a></div></div></footer><script>function siteTime(){window.setTimeout("siteTime()",1e3);var t=6e4,e=36e5,o=864e5,a=365*o,i=new Date,r=i.getFullYear(),n=i.getMonth()+1,g=i.getDate(),S=i.getHours(),d=i.getMinutes(),l=i.getSeconds(),s=Date.UTC(2022,8,28,0,0,0),M=Date.UTC(r,n,g,S,d,l)-s,m=Math.floor(M/a),T=Math.floor(M/o-365*m),f=Math.floor((M-(365*m+T)*o)/e),h=Math.floor((M-(365*m+T)*o-f*e)/t),u=Math.floor((M-(365*m+T)*o-f*e-h*t)/1e3),p=m.toString(),D=T.toString().padStart(3,"0"),c=f.toString().padStart(2,"0"),w=h.toString().padStart(2,"0"),C=u.toString().padStart(2,"0");document.getElementById("sitetime").innerHTML=" "+p+":"+D+":"+c+":"+w+":"+C}siteTime()</script><script src="//cdn.cbd.int/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/js/plugin.min.js"></script><script src="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/js/application.js"></script><script>!function(T){T.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/content.json"}}(window)</script><script src="https://cdn.cbd.int/mycpen-blog1@0.0.0-ezdbdrancx/js/insight.js"></script><script src="//cdn.cbd.int/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script><script>$(document).ready((function(){$("article img").not("[hidden]").not(".panel-body img").each((function(){var a=$(this),t=a.attr("alt"),n=a.parent("a");if(n.length<1){var e=this.getAttribute("src"),r=e.lastIndexOf("?");-1!=r&&(e=e.substring(0,r)),n=a.wrap('<a href="'+e+'"></a>').parent("a")}n.attr("data-fancybox","images"),t&&n.attr("data-caption",t)})),$().fancybox({selector:'[data-fancybox="images"]',hash:!1,loop:!1})}))</script><div id="go-top"></div><style>#go-top{width:40px;height:40px;background-color:plum;position:relative;border-radius:20px;position:fixed;right:20px;bottom:50px;cursor:pointer;display:none}#go-top:after{content:" ";position:absolute;left:14px;top:14px;border-top:2px solid #fff;border-right:2px solid #fff;width:12px;height:12px;transform:rotate(-45deg)}#go-top:hover{background-color:#8a2be2}</style><script>$((function(){var o=$("#go-top");$(window).scroll((function(){$(window).scrollTop()>300?o.show(300):o.hide(200),$("#go-top").click((function(){return $("body,html").animate({scrollTop:0}),(!1)()}))}))}))</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative;margin:0 0 24px}</style><script>addLoadEvent((()=>{$(".highlight").each((function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("一键复制").on("click",(function(t){var e=$(this).parent().find(".code")[0].innerText;e+="";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();var o=document.execCommand("copy");document.body.removeChild(n),o?$(this).text("复制成功"):$(this).text("复制失败"),$(this).blur()}))).on("mouseleave",(function(t){var e=$(this).find(".copy-btn");setTimeout((function(){e.text("一键复制")}),300)})).append(e)}))}))</script></body></html>